#include "Style.h"

void Fit03(){

	double pt[27], y[27], e1[27],e2[27],m[27];

  pt[0] =    0.125; y[0] =  3.48; e1[0] =  0.16; e2[0] =  0.23; m[0] = 1;
  pt[1] =    0.375; y[1] =  3.24; e1[1] =  0.10; e2[1] =  0.22; m[1] = 1;
  pt[2] =    0.625; y[2] =  2.82; e1[2] =  0.08; e2[2] =  0.19; m[2] = 1;
  pt[3] =    0.875; y[3] =  2.52; e1[3] =  0.06; e2[3] =  0.16; m[3] = 1;
  pt[4] =    1.125; y[4] =  2.07; e1[4] =  0.05; e2[4] =  0.13; m[4] = 1;
  pt[5] =    1.375; y[5] =  1.62; e1[5] =  0.04; e2[5] =  0.10; m[5] = 1;
  pt[6] =    1.625; y[6] =  1.20; e1[6] =  0.03; e2[6] =  0.08; m[6] = 1;
  pt[7] =    1.875; y[7] =  8.92; e1[7] =  0.21; e2[7] =  0.58; m[7] = 0.1;
  pt[8] =    2.125; y[8] =  6.50; e1[8] =  0.17; e2[8] =  0.42; m[8] = 0.1;
  pt[9] =    2.375; y[9] =  4.56; e1[9] =  0.13; e2[9] =  0.30; m[9] = 0.1;
  pt[10] =   2.625; y[10] =  3.16; e1[10] =  0.10; e2[10] =  0.21; m[10] = 0.1;
  pt[11] =   2.875; y[11] =  2.20; e1[11] =  0.08; e2[11] =  0.14; m[11] = 0.1;
  pt[12] =   3.125; y[12] =  1.51; e1[12] =  0.06; e2[12] =  0.10; m[12] = 0.1;
  pt[13] =   3.375; y[13] =  1.09; e1[13] =  0.05; e2[13] =  0.07; m[13] = 0.1;
  pt[14] =   3.625; y[14] =  7.71; e1[14] =  0.38; e2[14] =  0.50; m[14] = 0.01;
  pt[15] =   3.875; y[15] =  5.38; e1[15] =  0.31; e2[15] =  0.35; m[15] = 0.01;
  pt[16] =   4.125; y[16] =  3.30; e1[16] =  0.23; e2[16] =  0.22; m[16] = 0.01;
  pt[17] =   4.375; y[17] =  2.23; e1[17] =  0.18; e2[17] =  0.15; m[17] = 0.01;
  pt[18] =   4.625; y[18] =  1.44; e1[18] =  0.14; e2[18] =  0.09; m[18] = 0.01;
  pt[19] =   4.875; y[19] =  1.07; e1[19] =  0.12; e2[19] =  0.07; m[19] = 0.01;
  pt[20] =   5.125; y[20] =  9.19; e1[20] =  1.07; e2[20] =  0.60; m[20] = 0.001;
  pt[21] =   5.375; y[21] =  4.68; e1[21] =  0.72; e2[21] =  0.31; m[21] = 0.001;
  pt[22] =   5.625; y[22] =  3.28; e1[22] =  0.57; e2[22] =  0.22; m[22] = 0.001;
  pt[23] =   5.875; y[23] =  1.96; e1[23] =  0.44; e2[23] =  0.13; m[23] = 0.001;
  pt[24] =   6.250; y[24] =  1.17; e1[24] =  0.22; e2[24] =  0.08; m[24] = 0.001;
  pt[25] =   6.750; y[25] =  7.98; e1[25] =  1.76; e2[25] =  0.52; m[25] = 0.0001;
  pt[26] =   7.500; y[26] =  1.91; e1[26] =  0.73; e2[26] =  0.13; m[26] = 0.0001;

	for(int i=0; i<27; i++)
	{
		float dpt = 0.25;
		if ( i==24 || i==25 ) dpt = 0.50;
		else if ( i==26 ) dpt = 1.0;
		//sum += y[i]*m[i]*pt[i]*dpt*1.0*2*TMath::Pi();
		y[i] = y[i]*m[i]/42.0*1e-6;
		e1[i] = sqrt(e1[i]*e1[i] + e2[i]*e2[i]);
		e1[i] = e1[i]*m[i]/42.0*1e-6;
	}

	TGraphErrors *pt_Jpsi = new TGraphErrors(27,pt,y,0,e1);

	TF1 *pt_Jpsi_fit = new TF1("pt_Jpsi_fit"," [2]/ pow( ((exp(-[0]*x - [1]*x*x)) + x/[3]), [4])",0,10);
	pt_Jpsi_fit->SetParameter(0,0.1);
	pt_Jpsi_fit->SetParameter(1,-0.01);
	pt_Jpsi_fit->SetParameter(2,1e-7);
	pt_Jpsi_fit->SetParameter(3,1);
	pt_Jpsi_fit->SetParameter(4,10);


	TCanvas *c1 = new TCanvas("c1","c1",1.2*500,500);
	SetPadStyle();
	gPad->SetLogy();

	htmp = (TH1F*)gPad->DrawFrame(0,5e-13,8,1e-5);
	SetHistoStyle("p_{T} (GeV/c)","B_{#mu#mu}/2#pip_{T} d^{2}N/dydp_{T} [(GeV/c)^{-2}]","",24,20);
	pt_Jpsi->SetMarkerStyle(20);
	pt_Jpsi->SetLineColor(1);
	pt_Jpsi->SetLineWidth(2);
	pt_Jpsi->Draw("P");

	pt_Jpsi->Fit(pt_Jpsi_fit,"R0Q");
	pt_Jpsi_fit->Draw("same");


	TLegend *leg = new TLegend(0.3,0.75,0.9,0.9);
	leg->SetFillStyle(0);
	leg->SetBorderSize(0);
	leg->SetTextSize(0.05);
	leg->AddEntry("","p+p 200 GeV","");
	leg->AddEntry(pt_Jpsi_fit,"J/#psi, 1.2<|y|<2.2","");
	leg->Draw();



}
